<!DOCTYPE html>
<html>
<head>
    <title>Google Analytics Data</title>
    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        function authenticate() {
            return gapi.auth2.getAuthInstance()
                .signIn({scope: "https://www.googleapis.com/auth/analytics.readonly"})
                .then(function() { console.log("Sign-in successful"); },
                      function(err) { console.error("Error signing in", err); });
        }
        function loadClient() {
            gapi.client.setApiKey("AIzaSyCSHjM8bynxK8SAI-gQqwHtpiCvnpSlOTE");
            return gapi.client.load("https://analyticsreporting.googleapis.com/$discovery/rest?version=v4")
                .then(function() { console.log("GAPI client loaded for API"); },
                      function(err) { console.error("Error loading GAPI client for API", err); });
        }
        // Make sure the client is loaded and sign-in is complete before calling this method.
        function execute() {
            return gapi.client.analyticsreporting.reports.batchGet({
                "reportRequests": [
                    {
                        "viewId": "G-57HC51BKQ6",
                        "dateRanges": [
                            {
                                "startDate": "7daysAgo",
                                "endDate": "today"
                            }
                        ],
                        "metrics": [
                            {
                                "expression": "ga:sessions"
                            }
                        ]
                    }
                ]
            })
            .then(function(response) {
                    // Log response
                    console.log(response);
                },
                function(err) { console.error("Execute error", err); });
        }
        gapi.load("client:auth2", function() {
            gapi.auth2.init({client_id: "227800955261-2bjc8lga6h57gdv78flkrk7btbe5nmli.apps.googleusercontent.com"});
        });
    </script>
</head>
<body>
    <button onclick="authenticate().then(loadClient)">Authorize and Load</button>
    <button onclick="execute()">Execute</button>
</body>
</html>
